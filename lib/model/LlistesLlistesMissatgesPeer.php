<?php

require 'lib/model/om/BaseLlistesLlistesMissatgesPeer.php';


/**
 * Skeleton subclass for performing query and update operations on the 'llistes_llistes_missatges' table.
 *
 * 
 *
 * This class was autogenerated by Propel 1.4.2 on:
 *
 * 10/25/11 13:08:50
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    lib.model
 */
class LlistesLlistesMissatgesPeer extends BaseLlistesLlistesMissatgesPeer {

    static public function doGuardar($idM, $A_llistes){
        //Seleccionem les actuals del missatge
        //Reutilitzem les que ja hi ha amb les noves i les que sobren les esborrem.
        $C = new Criteria();
        $C->add(self::IDMISSATGE, $idM);
        $GUARDATS = array();
        
        foreach(self::doSelect($C) as $OLLM):
            if(isset($A_llistes[$OLLM->getIdllista()])) unset($A_llistes[$OLLM->getIdllista()]);
            else $OLLM->setActiu(false);            
        endforeach;
        
        foreach($A_llistes as $idL => $idL2):
            $OLLM = new LlistesLlistesMissatges();
            $OLLM->setIdllista($idL);
            $OLLM->setIdmissatge($idM);
            $OLLM->setActiu(true);
            $OLLM->save();            
        endforeach;
    }

} // LlistesLlistesMissatgesPeer
