<?php

require 'lib/model/om/BaseEntradesReserva.php';


/**
 * Skeleton subclass for representing a row from the 'entrades_reserva' table.
 *
 * 
 *
 * This class was autogenerated by Propel 1.4.2 on:
 *
 * 04/27/11 14:57:30
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    lib.model
 */
class EntradesReserva extends BaseEntradesReserva {

    public function getEstatString()
    {
        return EntradesReservaPeer::getEstatToString($this->getEstat());        
    }

    public function setInactiu()
    {
        $this->setActiu(false);
        $this->save();
    }

    public function getActivitat(){                
        return ActivitatsPeer::retrieveByPK($this->getEntradesPreusActivitatId());                
    }

    public function getTelefon(){
        //Si no hem entrat l'usuari i hem entrat el correu.
        if(!is_null($this->getUsuariId()) && is_null($this->getTelefonReserva())):
            $OU = UsuarisPeer::retrieveByPK($this->getUsuariId());
            if($OU instanceof Usuaris) return $OU->getTelefon();
            else return $this->getTelefonReserva();            
        else: 
            return $this->getTelefonReserva();
        endif;  
    }

    public function getEmail(){
        //Si no hem entrat l'usuari i hem entrat el correu.
        if(!is_null($this->getUsuariId()) && is_null($this->getEmailReserva())):
            $OU = UsuarisPeer::retrieveByPK($this->getUsuariId());
            if($OU instanceof Usuaris) return $OU->getEmail();
            else return $this->getEmailReserva();            
        else: 
            return $this->getEmailReserva();
        endif;  
    }

    public function getNomUsuari(){
        //Si Ã©s un usuari, el busquem, altrament marquem el nom que hem entrat
        if(is_null($this->getUsuariId())):
            $OU = UsuarisPeer::retrieveByPK($this->getUsuariId());
            if($OU instanceof Usuaris) return $OU->getNomComplet();
            else return $this->getNomReserva();            
        else: 
            return $this->getNomReserva();
        endif;
    }

    public function getNomActivitat(){
        $OA = $this->getActivitat();
        if($OA instanceof Activitats):
            return $OA->getNom();;
        else: 
            return "n/d";
        endif;
    }
    
    public function getHorari()
    {
        $OH = HorarisPeer::retrieveByPK($this->getEntradesPreusHorariId());
        if($OH instanceof Horaris):
            return $OH; 
        else: 
            $OH = new Horaris();
        endif;
    }
    
    public function getDescompteString(){
        $AD = DescomptesPeer::getDescomptesArray($this->getSiteId(),false,false);
        return $AD[$this->getDescompte()];
    }
    

} // EntradesReserva
